<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>New Week Update â€“ C3 Tool Manual</title>
  <style>
    :root {
      --navy-blue: #163147;
      --orange: #ed8a15;
      --light-grey: #b9b9ba;
      --dark-grey: #474d51;
      --white: #ffffff;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--light-grey);
      color: var(--dark-grey);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background-color: var(--navy-blue);
      color: var(--white);
      padding: 20px;
    }
    .header-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .header-container img {
      height: 120px;
      max-width: 120px;
    }
    .header-container div {
      flex: 1;
      text-align: center;
    }
    .header-container h1 {
      margin: 0;
      font-weight: 700;
      font-size: 2rem;
    }
    .header-container p {
      margin: 4px 0 0 0;
      font-weight: 500;
      font-size: 1.5rem;
    }
    nav {
      width: 240px;
      background-color: var(--navy-blue);
      color: var(--white);
      padding: 30px 15px;
      box-sizing: border-box;
      min-height: 100vh;
    }
    nav h2 {
      font-size: 18px;
      margin-top: 0;
    }
    nav a {
      display: flex;
      align-items: center;
      color: var(--white);
      text-decoration: none;
      margin: 12px 0;
      font-size: 15px;
      transition: 0.2s;
      padding-left: 12px;
      width: 100%;
      box-sizing: border-box;
    }
    nav a:hover {
      color: var(--orange);
    }
    nav a.active {
      background-color: var(--orange);
      color: var(--navy-blue);
      font-weight: bold;
      border-left: 4px solid var(--white);
    }
    nav img {
      width: 30px;
      margin-right: 8px;
    }
    .main-wrapper {
      display: flex;
      flex: 1;
    }
    main {
      flex: 1;
      padding: 40px;
      background-color: var(--white);
    }
    main header h1 {
      margin: 0;
      font-size: 28px;
      color: var(--navy-blue);
    }
    main header p {
      margin: 5px 0 20px;
      color: var(--dark-grey);
    }
    section {
      margin-bottom: 40px;
    }
    section h2 {
      color: var(--navy-blue);
      border-bottom: 2px solid var(--orange);
      padding-bottom: 4px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    table th, table td {
      border: 1px solid var(--light-grey);
      padding: 10px;
      text-align: left;
      vertical-align: top;
    }
    table th {
      background-color: var(--navy-blue);
      color: var(--white);
    }
    ul, ol {
      margin-top: 10px;
      padding-left: 20px;
    }
    pre {
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      padding: 15px;
      overflow-x: auto;
      font-family: Consolas, monospace;
      border-radius: 5px;
      font-size: 14px;
      white-space: pre-wrap;
    }
    .note {
      background-color: #fff3cd;
      border-left: 6px solid #ffeeba;
      padding: 10px 15px;
      margin-top: 15px;
      border-radius: 5px;
    }
    footer {
      background-color: var(--navy-blue);
      color: var(--white);
      text-align: center;
      padding: 15px;
      font-size: 14px;
      margin-top: auto;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container">
      <img src="images/company-logo.png" alt="Company Logo" />
      <div>
        <h1>C3 Tool â€“ User Manual</h1>
        <p>New Week Update</p>
      </div>
    </div>
  </header>

  <div class="main-wrapper">
    <nav>
      <h2>Navigation</h2>
      <a href="index.html"><img src="icons/home.png" alt="Home icon" />Home</a>
      <a href="text-case.html"><img src="icons/text.png" alt="Text Case Icon" />Text Case Conversion</a>
      <a href="Trim-Spaces.html"><img src="icons/Trim.png" alt="Trim Spaces Icon" />Trim Spaces</a>
      <a href="C3-Table.html"><img src="icons/C3Table.png" alt="C3 Table Icon" />C3 Table Format</a>
      <a href="C3-Pivot.html"><img src="icons/C3Pivot.png" alt="C3 Pivot Icon" />C3 Pivot Table Format</a>
      <a href="New-Week.html" class="active"><img src="icons/NewWeek.png" alt="New Week Icon" />New Week AutoUpdate</a>
      <a href="WBS-Coloring.html"><img src="icons/P6Table.png" alt="WBS Coloring Icon" />WBS Coloring</a>
      <a href="WBS-Grouping.html"><img src="icons/WBSGrouping.png" alt="WBS Grouping Icon" />WBS Grouping</a>
      <a href="WBS-Tabular.html"><img src="icons/Tabular.png" alt="WBS Tabular Icon" />WBS Tabular</a>
      <a href="Gantt-Chart.html"><img src="icons/Gantt.png" alt="Gantt Chart Icon" />Gantt Chart</a>
      <a href="Color-Setting.html"><img src="icons/Color.png" alt="Color Setting Icon" />Color Setting</a>
      <a href="Import-XER.html"><img src="icons/IMPORTXER.png" alt="IMPORT XER Icon" />Import XER</a>
      <a href="Export-XER.html"><img src="icons/EXPORTXER.png" alt="Export XER Icon" />Export XER</a>
      <a href="Resource-Generation.html"><img src="icons/ResourceGeneration.png" alt="Resource Generation Icon" />Resource Generation</a>
      <a href="AI-Assistant.html"><img src="icons/AI%20Assistant.png" alt="AI Assistant Icon" />AI Assistant</a>
    </nav>

    <main>
      <section>
        <h2>Overview</h2>
        <p>
          The <strong>New Week Update</strong> button automates the process of updating weekly data across multiple sheets in the workbook, ensuring that the dashboard, S-curve, tables, and database sheets are refreshed and synchronized with the new week's dates.
        </p>
      </section>

<section>
  <h2>Key Features</h2>
  <ul>
    <li>
      Automatically increments the weekly <strong>FO4 date</strong>, which is stored in a specific cell configured in the <code>Settings</code> sheet.
      The FO4 cell address and the sheet name containing it are defined via named settings in the <code>Settings</code> sheet.
    </li>
    <li>Updates data ranges in related sheets (S-curve, Tables Word, Dashboard) based on this configuration.</li>
    <li>Displays a progress form during processing for user feedback.</li>
    <li>Includes detailed error handling with messages and logging.</li>
  </ul>

<section>
  <h2>Sample Settings Sheet Layout</h2>
  <p>
    The <code>Settings</code> sheet contains multiple columns and blocks defining key configuration values and data ranges used by the <strong>New Week</strong> update process.
    Below is a sample layout illustrating the columns and typical data.
  </p>

  <table>
    <thead>
      <tr>
        <th>Setting Key</th>
        <th>Value</th>
        <th>CopyBlock</th>
        <th>Row1</th>
        <th>Row2</th>
        <th>TW_SourceRange</th>
        <th>TW_TargetRange</th>
        <th>DB_SourceRange</th>
        <th>DB_TargetRange</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>DashboardSheet</td>
        <td>Dashboard</td>
        <td>Block1</td>
        <td>6</td>
        <td>7</td>
        <td>N13:N21</td>
        <td>M13:M21</td>
        <td>Bk13:Bq14</td>
        <td>Br13:Bx14</td>
      </tr>
      <tr>
        <td>FO4Cell</td>
        <td>FO4</td>
        <td>Block2</td>
        <td>13</td>
        <td>14</td>
        <td>T24:V28</td>
        <td>Q24:S28</td>
        <td>Bk15:Bq16</td>
        <td>Br15:Bx16</td>
      </tr>
      <tr>
        <td>ScurveSheet</td>
        <td>S-curve</td>
        <td>Block3</td>
        <td>20</td>
        <td>21</td>
        <td>AC30:AC41</td>
        <td>AB30:AB41</td>
        <td>Bk17:Bq18</td>
        <td>Br17:Bx18</td>
      </tr>
      <tr>
        <td>DateHeaderRow</td>
        <td>2</td>
        <td>Block4</td>
        <td>30</td>
        <td>31</td>
        <td></td>
        <td></td>
        <td>Bk19:Bq20</td>
        <td>BR19:BX20</td>
      </tr>
      <tr>
        <td>TablesWordSheet</td>
        <td>Tables in Word</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>Bk21:Bq22</td>
        <td>BR21:BX22</td>
      </tr>
      <tr>
        <td>Dashboard2Sheet</td>
        <td>DASHBOARD</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>Bk23:Bq24</td>
        <td>BR23:BX24</td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>Bk25:Bq26</td>
        <td>BR25:BX26</td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>Bk27:Bq28</td>
        <td>BR27:BX28</td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>Bk29:Bq30</td>
        <td>BR29:BX30</td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>Bk31:Bq32</td>
        <td>BR31:BX32</td>
      </tr>
    </tbody>
  </table>

  <p><em>Notes:</em></p>
  <ul>
    <li><strong>Setting Key:</strong> Identifies the purpose or the sheet name.</li>
    <li><strong>Value:</strong> The associated sheet name or key value.</li>
    <li><strong>CopyBlock, Row1, Row2:</strong> Used to define ranges and row references for updating the S-curve or other sheets.</li>
    <li><strong>TW_SourceRange / TW_TargetRange:</strong> Source and target ranges on the Tables Word sheet for data copying.</li>
    <li><strong>DB_SourceRange / DB_TargetRange:</strong> Source and target ranges on the Dashboard sheets for data copying.</li>
    <li>The empty rows at the bottom represent continuation of Dashboard source and target ranges for batch updates.</li>
  </ul>
    <div class="note">
    ðŸ’¡ <strong>Tip:</strong> If the <code>Settings</code> sheet does not exist in your workbook, you can create a new sheet named <strong>Settings</strong> and copy the above sample table into it to ensure proper functionality of the <strong>New Week</strong> button.
  </div>
</section>


      <section>
        <h2>How to Use</h2>
        <ol>
          <li>Open your Excel workbook with the C3 Tool loaded.</li>
          <li>Ensure your <code>Settings</code> sheet is properly configured with sheet names, FO4 date cell, and row settings.</li>
          <li>Select the <strong>New Week Update</strong> button from the ribbon.</li>
          <li>The process will run automatically, updating relevant sheets and showing progress.</li>
          <li>Wait until the process completes and a confirmation message appears.</li>
        </ol>
      </section>

      
      <section>
        <h2>Technical Details</h2>
        <p>The update process includes the following key steps:</p>
        <ul>
          <li>Reading configuration and sheet names from the <code>Settings</code> worksheet.</li>
          <li>Validating the FO4 date cell and finding corresponding date columns in the S-curve sheet.</li>
          <li>Iterating through configuration rows to:</li>
          <ul>
            <li>Copy and update formulas in the S-curve sheet.</li>
            <li>Copy data ranges in the Tables Word sheet.</li>
            <li>Copy data ranges in the Dashboard2 sheet.</li>
          </ul>
          <li>Incrementing the FO4 date by 7 days after processing.</li>
          <li>Displaying progress to the user with a modeless form.</li>
          <li>Using comprehensive error handling and logging throughout.</li>
        </ul>
        <p>All processing is done efficiently with screen updating and events temporarily disabled to speed up the process.</p>
      </section>

      <section>
        <h2>Notes and Limitations</h2>
        <ul>
          <li>Ensure the <code>Settings</code> sheet contains accurate and complete configurations.</li>
          <li>Backup your workbook before running the update to prevent accidental data loss.</li>
          <li>The process assumes that date headers exist and match the FO4 date exactly in the S-curve sheet.</li>
          <li>The tool processes configuration rows until it finds an empty row in the specified range.</li>
          <li>Errors in individual rows log warnings but do not stop the entire update unless critical.</li>
        </ul>
        <div class="note">
          ðŸ’¡ <strong>Tip:</strong> Use this button weekly after finalizing data for the current week to keep all dashboards and reports up to date.
        </div>
      </section>

    </main>
  </div>

  <footer>
    Â© 2025 C3 â€“ All rights reserved.
  </footer>
</body>
</html>
